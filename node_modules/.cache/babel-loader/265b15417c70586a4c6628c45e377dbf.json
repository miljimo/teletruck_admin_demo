{"remainingRequest":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/babel-loader/lib/index.js!/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/src/views/Chat.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/src/views/Chat.vue","mtime":1600553567000},{"path":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/cache-loader/dist/cjs.js","mtime":1596790124748},{"path":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/babel-loader/lib/index.js","mtime":1596739166622},{"path":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/cache-loader/dist/cjs.js","mtime":1596790124748},{"path":"/Users/adeniranopeyemi/Documents/Horpey/Projects/Baby Diary Admin/node_modules/vue-loader/lib/index.js","mtime":1596739192596}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ChatContact from \"./ChatComponents/ChatContact.vue\";\nimport ChatLog from \"./ChatComponents/ChatLog.vue\";\nimport ChatNavbar from \"./ChatComponents/ChatNavbar.vue\";\nimport UserProfile from \"./ChatComponents/UserProfile.vue\";\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\nimport moduleChat from \"@/store/chat/moduleChat.js\";\nexport default {\n  data: function data() {\n    return {\n      active: true,\n      isHidden: false,\n      searchContact: \"\",\n      activeProfileSidebar: false,\n      activeChatUser: null,\n      userProfileId: -1,\n      typedMessage: \"\",\n      isChatPinned: false,\n      settings: {\n        maxScrollbarLength: 60,\n        wheelSpeed: 0.7\n      },\n      clickNotClose: true,\n      isChatSidebarActive: true,\n      isLoggedInUserProfileView: false\n    };\n  },\n  watch: {\n    windowWidth: function windowWidth() {\n      this.setSidebarWidth();\n    }\n  },\n  computed: {\n    chatLastMessaged: function chatLastMessaged() {\n      var _this = this;\n\n      return function (userId) {\n        return _this.$store.getters[\"chat/chatLastMessaged\"](userId);\n      };\n    },\n    chatUnseenMessages: function chatUnseenMessages() {\n      var _this2 = this;\n\n      return function (userId) {\n        var unseenMsg = _this2.$store.getters[\"chat/chatUnseenMessages\"](userId);\n\n        if (unseenMsg) return unseenMsg;\n      };\n    },\n    activeUser: function activeUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getStatusColor: function getStatusColor() {\n      var _this3 = this;\n\n      return function (isActiveUser) {\n        var userStatus = _this3.getUserStatus(isActiveUser);\n\n        if (userStatus === \"online\") {\n          return \"success\";\n        } else if (userStatus === \"do not disturb\") {\n          return \"danger\";\n        } else if (userStatus === \"away\") {\n          return \"warning\";\n        } else {\n          return \"grey\";\n        }\n      };\n    },\n    chatContacts: function chatContacts() {\n      return this.$store.getters[\"chat/chatContacts\"];\n    },\n    contacts: function contacts() {\n      return this.$store.getters[\"chat/contacts\"];\n    },\n    searchQuery: {\n      get: function get() {\n        return this.$store.state.chat.chatSearchQuery;\n      },\n      set: function set(val) {\n        this.$store.dispatch(\"chat/setChatSearchQuery\", val);\n      }\n    },\n    scrollbarTag: function scrollbarTag() {\n      return this.$store.getters.scrollbarTag;\n    },\n    isActiveChatUser: function isActiveChatUser() {\n      var _this4 = this;\n\n      return function (userId) {\n        return userId === _this4.activeChatUser;\n      };\n    },\n    windowWidth: function windowWidth() {\n      return this.$store.state.windowWidth;\n    }\n  },\n  methods: {\n    getUserStatus: function getUserStatus(isActiveUser) {\n      // return \"active\"\n      return isActiveUser ? this.$store.state.AppActiveUser.status : this.contacts[this.activeChatUser].status;\n    },\n    closeProfileSidebar: function closeProfileSidebar(value) {\n      this.activeProfileSidebar = value;\n    },\n    updateActiveChatUser: function updateActiveChatUser(contactId) {\n      this.activeChatUser = contactId;\n\n      if (this.$store.getters[\"chat/chatDataOfUser\"](this.activeChatUser)) {\n        this.$store.dispatch(\"chat/markSeenAllMessages\", contactId);\n      }\n\n      var chatData = this.$store.getters[\"chat/chatDataOfUser\"](this.activeChatUser);\n      if (chatData) this.isChatPinned = chatData.isPinned;else this.isChatPinned = false;\n      this.toggleChatSidebar();\n      this.typedMessage = \"\";\n    },\n    showProfileSidebar: function showProfileSidebar(userId) {\n      var openOnLeft = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      this.userProfileId = userId;\n      this.isLoggedInUserProfileView = openOnLeft;\n      this.activeProfileSidebar = !this.activeProfileSidebar;\n    },\n    sendMsg: function sendMsg() {\n      if (!this.typedMessage) return;\n      var payload = {\n        isPinned: this.isChatPinned,\n        msg: {\n          textContent: this.typedMessage,\n          time: String(new Date()),\n          isSent: true,\n          isSeen: false\n        },\n        id: this.activeChatUser\n      };\n      this.$store.dispatch(\"chat/sendChatMessage\", payload);\n      this.typedMessage = \"\";\n      var scroll_el = this.$refs.chatLogPS.$el || this.$refs.chatLogPS;\n      scroll_el.scrollTop = this.$refs.chatLog.scrollHeight;\n    },\n    toggleIsChatPinned: function toggleIsChatPinned(value) {\n      this.isChatPinned = value;\n    },\n    setSidebarWidth: function setSidebarWidth() {\n      if (this.windowWidth < 1200) {\n        this.isChatSidebarActive = this.clickNotClose = false;\n      } else {\n        this.isChatSidebarActive = this.clickNotClose = true;\n      }\n    },\n    toggleChatSidebar: function toggleChatSidebar() {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      if (!value && this.clickNotClose) return;\n      this.isChatSidebarActive = value;\n    }\n  },\n  components: {\n    VuePerfectScrollbar: VuePerfectScrollbar,\n    ChatContact: ChatContact,\n    UserProfile: UserProfile,\n    ChatNavbar: ChatNavbar,\n    ChatLog: ChatLog\n  },\n  created: function created() {\n    this.$store.registerModule(\"chat\", moduleChat);\n    this.$store.dispatch(\"chat/fetchContacts\");\n    this.$store.dispatch(\"chat/fetchChatContacts\");\n    this.$store.dispatch(\"chat/fetchChats\");\n    this.setSidebarWidth();\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.$store.unregisterModule(\"chat\");\n  },\n  mounted: function mounted() {\n    this.$store.dispatch(\"chat/setChatSearchQuery\", \"\");\n  }\n};",{"version":3,"sources":["Chat.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div\n    id=\"chat-app\"\n    class=\"border border-solid d-theme-border-grey-light rounded relative overflow-hidden\"\n  >\n    <vs-sidebar\n      class=\"items-no-padding\"\n      parent=\"#chat-app\"\n      :click-not-close=\"clickNotClose\"\n      :hidden-background=\"clickNotClose\"\n      v-model=\"isChatSidebarActive\"\n      id=\"chat-list-sidebar\"\n    >\n      <!-- USER PROFILE SIDEBAR -->\n      <user-profile\n        :active=\"activeProfileSidebar\"\n        :userId=\"userProfileId\"\n        class=\"user-profile-container\"\n        :isLoggedInUser=\"isLoggedInUserProfileView\"\n        @closeProfileSidebar=\"closeProfileSidebar\"\n      ></user-profile>\n\n      <div class=\"chat__profile-search flex p-4\">\n        <div class=\"relative inline-flex\">\n          <vs-avatar\n            v-if=\"activeUser.photoURL\"\n            class=\"m-0 border-2 border-solid border-white\"\n            :src=\"activeUser.photoURL\"\n            size=\"40px\"\n            @click=\"showProfileSidebar(Number(activeUser.uid), true)\"\n          />\n          <div\n            class=\"h-3 w-3 border-white border border-solid rounded-full absolute right-0 bottom-0\"\n            :class=\"'bg-' + getStatusColor(true)\"\n          ></div>\n        </div>\n        <vs-input\n          icon-no-border\n          icon=\"icon-search\"\n          icon-pack=\"feather\"\n          class=\"w-full mx-5 input-rounded-full\"\n          placeholder=\"Search or start a new chat\"\n          v-model=\"searchQuery\"\n        />\n\n        <feather-icon\n          class=\"md:inline-flex lg:hidden -ml-3 cursor-pointer\"\n          icon=\"XIcon\"\n          @click=\"toggleChatSidebar(false)\"\n        />\n      </div>\n\n      <vs-divider class=\"d-theme-border-grey-light m-0\" />\n      <component\n        :is=\"scrollbarTag\"\n        class=\"chat-scroll-area pt-4\"\n        :settings=\"settings\"\n        :key=\"$vs.rtl\"\n      >\n        <!-- ACTIVE CHATS LIST -->\n        <div class=\"chat__chats-list mb-8\">\n          <h3 class=\"text-primary mb-5 px-4\">Chats</h3>\n          <ul class=\"chat__active-chats bordered-items\">\n            <li\n              class=\"cursor-pointer\"\n              v-for=\"(contact, index) in chatContacts\"\n              :key=\"index\"\n              @click=\"updateActiveChatUser(contact.uid)\"\n            >\n              <chat-contact\n                showLastMsg\n                :contact=\"contact\"\n                :lastMessaged=\"chatLastMessaged(contact.uid).time\"\n                :unseenMsg=\"chatUnseenMessages(contact.uid)\"\n                :isActiveChatUser=\"isActiveChatUser(contact.uid)\"\n              ></chat-contact>\n            </li>\n          </ul>\n        </div>\n\n        <!-- CONTACTS LIST -->\n        <div class=\"chat__contacts\">\n          <h3 class=\"text-primary mb-5 px-4\">Contacts</h3>\n          <ul class=\"chat__contacts bordered-items\">\n            <li\n              class=\"cursor-pointer\"\n              v-for=\"contact in contacts\"\n              :key=\"contact.uid\"\n              @click=\"updateActiveChatUser(contact.uid)\"\n            >\n              <chat-contact :contact=\"contact\"></chat-contact>\n            </li>\n          </ul>\n        </div>\n      </component>\n    </vs-sidebar>\n\n    <!-- RIGHT COLUMN -->\n    <div\n      class=\"chat__bg no-scroll-content chat-content-area border border-solid d-theme-border-grey-light border-t-0 border-r-0 border-b-0\"\n      :class=\"{'sidebar-spacer--wide': clickNotClose, 'flex items-center justify-center': activeChatUser === null}\"\n    >\n      <template v-if=\"activeChatUser\">\n        <div class=\"chat__navbar\">\n          <chat-navbar\n            :isSidebarCollapsed=\"!clickNotClose\"\n            :user-id=\"activeChatUser\"\n            :isPinnedProp=\"isChatPinned\"\n            @openContactsSidebar=\"toggleChatSidebar(true)\"\n            @showProfileSidebar=\"showProfileSidebar\"\n            @toggleIsChatPinned=\"toggleIsChatPinned\"\n          ></chat-navbar>\n        </div>\n        <component\n          :is=\"scrollbarTag\"\n          class=\"chat-content-scroll-area border border-solid d-theme-border-grey-light\"\n          :settings=\"settings\"\n          ref=\"chatLogPS\"\n          :key=\"$vs.rtl\"\n        >\n          <div class=\"chat__log\" ref=\"chatLog\">\n            <chat-log :userId=\"activeChatUser\" v-if=\"activeChatUser\"></chat-log>\n          </div>\n        </component>\n        <div class=\"chat__input flex p-4 bg-white\">\n          <vs-input\n            class=\"flex-1\"\n            placeholder=\"Type Your Message\"\n            v-model=\"typedMessage\"\n            @keyup.enter=\"sendMsg\"\n          />\n          <vs-button class=\"bg-primary-gradient ml-4\" type=\"filled\" @click=\"sendMsg\">Send</vs-button>\n        </div>\n      </template>\n      <template v-else>\n        <div class=\"flex flex-col items-center\">\n          <feather-icon\n            icon=\"MessageSquareIcon\"\n            class=\"mb-4 bg-white p-8 shadow-md rounded-full\"\n            svgClasses=\"w-16 h-16\"\n          ></feather-icon>\n          <h4\n            class=\"py-2 px-4 bg-white shadow-md rounded-full cursor-pointer\"\n            @click.stop=\"toggleChatSidebar(true)\"\n          >Start Conversation</h4>\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ChatContact from \"./ChatComponents/ChatContact.vue\";\nimport ChatLog from \"./ChatComponents/ChatLog.vue\";\nimport ChatNavbar from \"./ChatComponents/ChatNavbar.vue\";\nimport UserProfile from \"./ChatComponents/UserProfile.vue\";\nimport VuePerfectScrollbar from \"vue-perfect-scrollbar\";\nimport moduleChat from \"@/store/chat/moduleChat.js\";\n\nexport default {\n  data() {\n    return {\n      active: true,\n      isHidden: false,\n      searchContact: \"\",\n      activeProfileSidebar: false,\n      activeChatUser: null,\n      userProfileId: -1,\n      typedMessage: \"\",\n      isChatPinned: false,\n      settings: {\n        maxScrollbarLength: 60,\n        wheelSpeed: 0.7\n      },\n      clickNotClose: true,\n      isChatSidebarActive: true,\n      isLoggedInUserProfileView: false\n    };\n  },\n  watch: {\n    windowWidth() {\n      this.setSidebarWidth();\n    }\n  },\n  computed: {\n    chatLastMessaged() {\n      return userId => this.$store.getters[\"chat/chatLastMessaged\"](userId);\n    },\n    chatUnseenMessages() {\n      return userId => {\n        const unseenMsg = this.$store.getters[\"chat/chatUnseenMessages\"](\n          userId\n        );\n        if (unseenMsg) return unseenMsg;\n      };\n    },\n    activeUser() {\n      return this.$store.state.AppActiveUser;\n    },\n    getStatusColor() {\n      return isActiveUser => {\n        const userStatus = this.getUserStatus(isActiveUser);\n\n        if (userStatus === \"online\") {\n          return \"success\";\n        } else if (userStatus === \"do not disturb\") {\n          return \"danger\";\n        } else if (userStatus === \"away\") {\n          return \"warning\";\n        } else {\n          return \"grey\";\n        }\n      };\n    },\n    chatContacts() {\n      return this.$store.getters[\"chat/chatContacts\"];\n    },\n    contacts() {\n      return this.$store.getters[\"chat/contacts\"];\n    },\n    searchQuery: {\n      get() {\n        return this.$store.state.chat.chatSearchQuery;\n      },\n      set(val) {\n        this.$store.dispatch(\"chat/setChatSearchQuery\", val);\n      }\n    },\n    scrollbarTag() {\n      return this.$store.getters.scrollbarTag;\n    },\n    isActiveChatUser() {\n      return userId => userId === this.activeChatUser;\n    },\n    windowWidth() {\n      return this.$store.state.windowWidth;\n    }\n  },\n  methods: {\n    getUserStatus(isActiveUser) {\n      // return \"active\"\n      return isActiveUser\n        ? this.$store.state.AppActiveUser.status\n        : this.contacts[this.activeChatUser].status;\n    },\n    closeProfileSidebar(value) {\n      this.activeProfileSidebar = value;\n    },\n    updateActiveChatUser(contactId) {\n      this.activeChatUser = contactId;\n      if (this.$store.getters[\"chat/chatDataOfUser\"](this.activeChatUser)) {\n        this.$store.dispatch(\"chat/markSeenAllMessages\", contactId);\n      }\n      const chatData = this.$store.getters[\"chat/chatDataOfUser\"](\n        this.activeChatUser\n      );\n      if (chatData) this.isChatPinned = chatData.isPinned;\n      else this.isChatPinned = false;\n      this.toggleChatSidebar();\n      this.typedMessage = \"\";\n    },\n    showProfileSidebar(userId, openOnLeft = false) {\n      this.userProfileId = userId;\n      this.isLoggedInUserProfileView = openOnLeft;\n      this.activeProfileSidebar = !this.activeProfileSidebar;\n    },\n    sendMsg() {\n      if (!this.typedMessage) return;\n      const payload = {\n        isPinned: this.isChatPinned,\n        msg: {\n          textContent: this.typedMessage,\n          time: String(new Date()),\n          isSent: true,\n          isSeen: false\n        },\n        id: this.activeChatUser\n      };\n      this.$store.dispatch(\"chat/sendChatMessage\", payload);\n      this.typedMessage = \"\";\n\n      const scroll_el = this.$refs.chatLogPS.$el || this.$refs.chatLogPS;\n      scroll_el.scrollTop = this.$refs.chatLog.scrollHeight;\n    },\n    toggleIsChatPinned(value) {\n      this.isChatPinned = value;\n    },\n    setSidebarWidth() {\n      if (this.windowWidth < 1200) {\n        this.isChatSidebarActive = this.clickNotClose = false;\n      } else {\n        this.isChatSidebarActive = this.clickNotClose = true;\n      }\n    },\n    toggleChatSidebar(value = false) {\n      if (!value && this.clickNotClose) return;\n      this.isChatSidebarActive = value;\n    }\n  },\n  components: {\n    VuePerfectScrollbar,\n    ChatContact,\n    UserProfile,\n    ChatNavbar,\n    ChatLog\n  },\n  created() {\n    this.$store.registerModule(\"chat\", moduleChat);\n    this.$store.dispatch(\"chat/fetchContacts\");\n    this.$store.dispatch(\"chat/fetchChatContacts\");\n    this.$store.dispatch(\"chat/fetchChats\");\n    this.setSidebarWidth();\n  },\n  beforeDestroy() {\n    this.$store.unregisterModule(\"chat\");\n  },\n  mounted() {\n    this.$store.dispatch(\"chat/setChatSearchQuery\", \"\");\n  }\n};\n</script>\n\n\n<style lang=\"scss\">\n@import \"@/assets/scss/vuexy/apps/chat.scss\";\n</style>\n"],"sourceRoot":"src/views"}]}